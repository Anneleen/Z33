<!DOCTYPE html> 
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1"/>
	
	<title>Expo 1</title>
	<link rel="stylesheet" href="themes/z33.min.css"/>
	<script type="text/javascript" src="jquery/jquery-1.8.2.min.js"></script>
	<script type="text/javascript" src="jquery/jquery.mobile-1.2.0.min.js"></script>
	<script stype="text/javascript" src="phonegap.js"></script>
	
	<link rel="stylesheet" href="themes/responsiveslide.css"/>
	<script src="jquery/responsiveslides.min.js"></script>
	<script>
    $(function () {
      $(".rslides").responsiveSlides({
      auto: false, 
      pager: false, 
      nav: true, 
      speed: 500, 
      namespace: "callbacks"});
	});
	</script>
	
	<script>
	$('.link').live('tap', function() {
    url = $(this).attr("rel");   
    loadURL(url);
	});

	function loadURL(url){
    navigator.app.loadUrl(url, { openExternal:true });
    return false;
	}
	</script>

	<script>
		$(document).bind("mobileinit", function(){
  			$.mobile.listview.prototype.options.icon = false;
			$.mobile.defaultPageTransition = "none";
			$.mobile.allowCrossDomainPages = true;
			$.mobile.metaViewportContent = 'width=device-width';
		    $.event.special.swipe.horizontalDistanceThreshold = 25; 
   			$.event.special.swipe.verticalDistanceThreshold = 80;
    		$.event.special.swipe.scrollSupressionThreshold = 8;
		});
	</script>
	
	<script>

	$('div.ui-page').live("swipeleft", function () {
		var nextpage = $(this).next('div[data-role="page"]');
		if (nextpage.length > 0) {
			$.mobile.changePage(nextpage, "slide", false, true);
		}
	});
	$('div.ui-page').live("swiperight", function () {
		var prevpage = $(this).prev('div[data-role="page"]');
		if (prevpage.length > 0) {
			$.mobile.changePage(prevpage, {
				transition: "slide",
				reverse: true
			}, true, true);
		}
	});

	</script>
	
	<script src="jquery/jquery.imagesloaded.min.js"></script>
    <script src="jquery/imgcache.js"></script>
	
	<script>
			var startTest = function() {
					/* Note: this is using version 2.x of the imagesloaded library, use of current version might differ */
					$('body').imagesLoaded(function($images, $proper, $broken ) {

							// see console output for debug info
							ImgCache.options.debug = true;
							ImgCache.options.usePersistentCache = true;
	
							ImgCache.init(function() {
									// 1. cache images
									for (var i = 0; i < $proper.length; i++) {
											ImgCache.cacheFile($($proper[i]).attr('src'));
									}
									// 2. broken images get replaced
									for (var i = 0; i < $broken.length; i++) {
											ImgCache.useCachedFile($($broken[i]));
									}

							});
					});
			};

			if (typeof(cordova) !== 'undefined') {
					// cordova test
					document.addEventListener('deviceready', startTest, false);
			} else {
					// normal browser test
					$(document).ready(startTest);
			}
	</script>
	
	<script>
	var pathHome;

	function onFSSuccess(fileSystem) {
	pathHome = fileSystem.root.fullPath+'/be.z33.mobile/home.json';
    fileSystem.root.getDirectory("be.z33.mobile",{create:true},loadHome,onError);
	}

	function loadHome() {
	var request = new XMLHttpRequest();
	request.open("GET", pathHome, true);
	request.onreadystatechange = function() {//Call a function when the state changes.
	if (request.readyState == 4) {
	  if (request.status == 200 || request.status == 0) {
	  
	  var home = JSON.parse(request.responseText);
	  var data = "<table cellspacing='0'>";
	  for (i = 0; i < home.length; i++) {
		data += "<td>";
		data += "<a data-ajax='false' href='" + home[i].link + "'/>";
		data += "<figure><img style='max-width: 360px; max-height: 540px;' src='" + home[i].img_hr + "'/>";
		data += "<figcaption>" + home[i].expo + "<br><em>";
		data += home[i].datum + "</em></figcaption></figure></a></td>";
	  }
	  data += "</table>";
	  var twitter = document.getElementById("home");
	  twitter.innerHTML = data;
	  }
	}
	}
		console.log("asking for home");
		request.send();
	}

	function onError(e){
    console.log("ERROR");
    console.log(JSON.stringify(e));
	}

	function onDeviceReady() {
    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onFSSuccess, null);
	}    

	function init() {
	document.addEventListener("deviceready", onDeviceReady, false);
	}
	</script>
		
</head>

<body onload="init();">
<div data-theme="a" id="indexexpo" data-role="page" data-url="indexexpo">

	<div data-role="header" class="ui-header ui-bar-a" role="banner" data-position="fixed" data-tap-toggle="false">
	<div class="hd">
		<a href="example2.html" data-ajax="false" title="Z33" class="Z33"><span style="display:none;" data-position="fixed">Z33</span></a>
	</div>
	</div><!-- /header -->

	<div data-theme="a" data-role="content">
	
	<div class="iexpo">
	<table id="home">
	</table>
	</div>
	
	</div><!-- /content -->
	
</div>
</body>
</html>